<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>tic tac toe</title>
    <style>
      @import url("https://fonts.googleapis.com/css2?family=LXGW+WenKai+TC&display=swap");
@import url("https://fonts.googleapis.com/css2?family=Lexend:wght@100..900&display=swap");
.header {
  font-family: "LXGW WenKai TC", cursive;
  font-weight: 400;
  font-style: normal;
}
.header .title {
  display: flex;
  align-items: center;
  justify-content: center;
}

.container table {
  display: flex;
  justify-content: center;
  align-items: center;
  padding: 50px;
}
.container table .row .th1 {
  padding: 20px;
}
.container table .row .th1 .button1 {
  font-family: "Lexend", sans-serif;
  content: "";
}
.container table .row .th2 {
  padding: 20px;
}
.container table .row .th2 .button2 {
  font-family: "Lexend", sans-serif;
  content: "";
}
.container table .row .th3 {
  padding: 20px;
}
.container table .row .th3 .button3 {
  font-family: "Lexend", sans-serif;
  content: "";
}
.container table .row .th4 {
  padding: 20px;
}
.container table .row .th4 .button4 {
  font-family: "Lexend", sans-serif;
  content: "";
}
.container table .row .th5 {
  padding: 20px;
}
.container table .row .th5 .button5 {
  font-family: "Lexend", sans-serif;
  content: "";
}
.container table .row .th6 {
  padding: 20px;
}
.container table .row .th6 .button6 {
  font-family: "Lexend", sans-serif;
  content: "";
}
.container table .row .th7 {
  padding: 20px;
}
.container table .row .th7 .button7 {
  font-family: "Lexend", sans-serif;
  content: "";
}
.container table .row .th8 {
  padding: 20px;
}
.container table .row .th8 .button8 {
  font-family: "Lexend", sans-serif;
  content: "";
}
.container table .row .th9 {
  padding: 20px;
}
.container table .row .th9 .button9 {
  font-family: "Lexend", sans-serif;
  content: "";
}
.container table .row .th1 {
  border-bottom: 1px solid gray;
  border-right: 1px solid gray;
}
.container table .row .th2 {
  border-bottom: 1px solid gray;
  border-right: 1px solid gray;
  border-left: 1px solid gray;
}
.container table .row .th3 {
  border-bottom: 1px solid gray;
  border-left: 1px solid gray;
}
.container table .row .th4 {
  border-top: 1px solid gray;
  border-bottom: 1px solid gray;
  border-right: 1px solid gray;
}
.container table .row .th5 {
  border: 1px solid gray;
}
.container table .row .th6 {
  border-top: 1px solid gray;
  border-bottom: 1px solid gray;
  border-left: 1px solid gray;
}
.container table .row .th7 {
  border-top: 1px solid gray;
  border-right: 1px solid gray;
}
.container table .row .th8 {
  border-top: 1px solid gray;
  border-right: 1px solid gray;
  border-left: 1px solid gray;
}
.container table .row .th9 {
  border-top: 1px solid gray;
  border-left: 1px solid gray;
}/*# sourceMappingURL=sass.css.map */
    </style>
</head>
<body>
    <div class="header">
        <h2 class="title">
            Special Tic-Tac-Toe Game
        </h2>
        <h4 class="second-title">
            Rules:
        </h4>
        <p class="rules">
            Normal Tic-Tac-Toe Game but you are only allowed to put 3 X's / O's 
            ,Once you play your three turns you can change the place of the very first X/O you have played
             to another square
        </p>
    </div>
    <div class="container">
        <table>
            <tr class="row">
                <th class="th1">
                    <button class="button1"><p class="button-text1"></p></button>
                </th>
                <th class="th2">
                    <button class="button2"><p class="button-text2"></p></button>
                </th>
                <th class="th3">
                    <button class="button3"><p class="button-text3"></p></button>
                </th>
            </tr>
            <tr class="row">
                <th class="th4">
                    <button class="button4"><p class="button-text4"></p></button>
                </th>
                <th class="th5">
                    <button class="button5"><p class="button-text5"></p></button>
                </th>
                <th class="th6">
                    <button class="button6"><p class="button-text6"></p></button>
                </th>
            </tr>
            <tr class="row">
                <th class="th7">
                    <button class="button7"><p class="button-text7"></p></button>
                </th>
                <th class="th8">
                    <button class="button8"><p class="button-text8"></p></button>
                </th>
                <th class="th9">
                    <button class="button9"><p class="button-text9"></p></button>
                </th>
            </tr>
        </table>
        <p class="print"></p>
        <button class="reset">reset</button>
    </div>
    <script>
var b1, b2, b3, b4, b5, b6, b7, b8, b9;
b1 = document.getElementsByClassName("th1");
b2 = document.getElementsByClassName("th2");
b3 = document.getElementsByClassName("th3");
b4 = document.getElementsByClassName("th4");
b5 = document.getElementsByClassName("th5");
b6 = document.getElementsByClassName("th6");
b7 = document.getElementsByClassName("th7");
b8 = document.getElementsByClassName("th8");
b9 = document.getElementsByClassName("th9");

var b1btn, b2btn, b3btn, b4btn, b5btn, b6btn, b7btn, b8btn, b9btn, resetbtn;
b1btn = document.getElementsByClassName("button1");
b2btn = document.getElementsByClassName("button2");
b3btn = document.getElementsByClassName("button3");
b4btn = document.getElementsByClassName("button4");
b5btn = document.getElementsByClassName("button5");
b6btn = document.getElementsByClassName("button6");
b7btn = document.getElementsByClassName("button7");
b8btn = document.getElementsByClassName("button8");
b9btn = document.getElementsByClassName("button9");
resetbtn = document.getElementsByClassName("reset");

let mainarr = [0];
let btnarr = []
let turnCount = 0;

function isEven(mainarr) {
  if (mainarr.length % 2 === 0) {
    return true;
  } else {
    return false;
  }
}

function showX(element) {
  const buttonText = element.children[0];
  if (buttonText) {
    buttonText.textContent = "X";
  }
}

function showO(element) {
  const buttonText = element.children[0];
  if (buttonText) {
    buttonText.textContent = "O";
  }
}

function checkIfPlayed(element) {
  if (element.dataset && element.dataset.clicked === "true") {
    return true;
  } else {
    return false;
  }
}

function removeMove() {
  if (btnarr.length > 0) {
    const classNameToRemove = btnarr[0];
    const button = document.querySelector(`.${classNameToRemove}`);
    if (button) {
      button.children[0].textContent = '';
      button.dataset.clicked = "false"; 
    }
    btnarr.shift(); 
  }
}

function special() {
  if (mainarr.length === 7) {
    removeMove();
    removeMove();
  }
}

function resetButtonColors() {
  const buttons = [b1btn, b2btn, b3btn, b4btn, b5btn, b6btn, b7btn, b8btn, b9btn];
  buttons.forEach(buttonCollection => {
    for (let i = 0; i < buttonCollection.length; i++) {
      const buttonText = buttonCollection[i].children[0];
      if (buttonText) {
        buttonText.style.color = "";
      }
    }
  });
}

function firstMove() {
  if (turnCount === 6) {
    resetButtonColors(); 
    highlightFirstButton(0);
  }
  if (turnCount > 6) {
    resetButtonColors();
    highlightFirstButton(0);
  }
}

function highlightFirstButton(btnIndex) {
  if (btnIndex >= 0 && btnIndex < btnarr.length) {
    let firstBtnClass = btnarr[btnIndex];
    let firstBtnElements = document.getElementsByClassName(firstBtnClass);
    
    if (firstBtnElements.length > 0) {
      let firstBtn = firstBtnElements[0];
      let buttonText = firstBtn.children[0];
      if (buttonText) {
        buttonText.style.color ="red";
        console.log("Button text color changed to red:", buttonText);
      } else {
        console.error("Button text not found:", firstBtn);
      }
    } else {
      console.error("No elements found with class:", firstBtnClass);
    }
  } else {
    console.error("Invalid button index:", btnIndex);
  }
}

function reset() {
  const buttons = [b1btn, b2btn, b3btn, b4btn, b5btn, b6btn, b7btn, b8btn, b9btn];
  buttons.forEach(buttonCollection => {
    for (let i = 0; i < buttonCollection.length; i++) {
      const buttonText = buttonCollection[i].children[0];
      if (buttonText) {
        buttonText.textContent = '';
        buttonText.style.color = ''; 
      }
      buttonCollection[i].removeAttribute('disabled');
      buttonCollection[i].style.display = "block";
      buttonCollection[i].dataset.clicked = "false";
      turnCount = 0;
    }
  });

  btnarr = [];
  mainarr.splice(1);
}

function turns(element) {
  if (checkIfPlayed(element)) {
    return;
  }

  if (isEven(mainarr)) {
    showO(element);
  } else {
    showX(element);
  }
  
  element.dataset.clicked = "true";
  mainarr.push(mainarr.length);
  btnarr.push(element.className);
  turnCount++;
  console.log(turnCount);
  console.log(btnarr);

  if (turnCount > 6) {
    removeMove();
  }
}

function checkForWins() {
  const winningCombinations = [
    [b1btn, b2btn, b3btn],
    [b4btn, b5btn, b6btn],
    [b7btn, b8btn, b9btn],
    [b1btn, b4btn, b7btn],
    [b2btn, b5btn, b8btn],
    [b3btn, b6btn, b9btn],
    [b1btn, b5btn, b9btn],
    [b3btn, b5btn, b7btn],
  ];
  
  const playerX = 'X';
  const playerO = 'O';

  for (const combination of winningCombinations) {
    const allX = combination.every(cellElement => cellElement[0].textContent === playerX);
    const allO = combination.every(cellElement => cellElement[0].textContent === playerO);

    if (allX) {
      document.querySelector('.print').innerHTML = "Player X won";
      disableButtons();
      return; 
    } else if (allO) {
      document.querySelector('.print').innerHTML = "Player O won";
      disableButtons();
      return;
    }
  }

const allCellsFilled =  Array.from(b1btn).every(button => button.dataset.clicked === "true") &&
                        Array.from(b2btn).every(button => button.dataset.clicked === "true") &&
                        Array.from(b3btn).every(button => button.dataset.clicked === "true") &&
                        Array.from(b4btn).every(button => button.dataset.clicked === "true") &&
                        Array.from(b5btn).every(button => button.dataset.clicked === "true") &&
                        Array.from(b6btn).every(button => button.dataset.clicked === "true") &&
                        Array.from(b7btn).every(button => button.dataset.clicked === "true") &&
                        Array.from(b8btn).every(button => button.dataset.clicked === "true") &&
                        Array.from(b9btn).every(button => button.dataset.clicked === "true");

if (allCellsFilled) {
    document.querySelector('.print').innerHTML = "Match Tie";
    disableButtons();
} else {
    document.querySelector('.print').innerHTML = isEven(mainarr) ? "Player O Turn" : "Player X Turn";
}

}
  
function disableButtons() {
  const buttons = [b1btn, b2btn, b3btn, b4btn, b5btn, b6btn, b7btn, b8btn, b9btn];
  buttons.forEach(buttonCollection => {
      for (let i = 0; i < buttonCollection.length; i++) {
          buttonCollection[i].setAttribute('disabled', true);
      }
  });
}
  
function highlightWinningCells(cells, player) {
    const winningColor = player === 'X' ? 'red' : 'blue';
    for (const cell of cells) {
      cell.style.backgroundColor = winningColor;
    }
  }

  function playingTurns(mainarr) {
    const buttons = [b1btn, b2btn, b3btn, b4btn, b5btn, b6btn, b7btn, b8btn, b9btn];
    buttons.forEach(buttonCollection => {
      for (let i = 0; i < buttonCollection.length; i++) {
        const button = buttonCollection[i];
        button.addEventListener("click", function () {
          turns(this);
          checkForWins();
          firstMove();
        });
      }
    });
    resetbtn[0].addEventListener("click", reset);
  }

playingTurns(mainarr);
    </script>
</body>
</html>